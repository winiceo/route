{"version":3,"sources":["../../../app/controller/miner.js"],"names":["_","require","validator","utility","uuid","module","exports","MinerController","ctx","service","config","ret","status","message","data","uid","account","user_id","miner","getByUserId","assets","body","miner_id","params","request","query","page","parseInt","pageSize","console","log","getSharesByMinerId","pageNumber","miner_shares","id","miner_alias","rename","app","Controller"],"mappings":"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","file":"miner.js","sourcesContent":["\nconst _ = require('lodash');\nconst validator = require('validator');\nconst utility = require('utility');\nconst uuid = require('uuid');\n\nmodule.exports = app => {\n    class MinerController extends app.Controller {\n\n        async index() {\n            const { ctx, service, config } = this;\n\n            const ret = {\n                status: 200,\n                message: '',\n                data: {}\n            };\n\n            const uid = ctx.account.user_id;\n\n            const assets = await service.miner.getByUserId(uid);\n            const data = {\n                assets: {\n                    'yesterday_balance':\n                        2.5,\n                    'lrc_cny':\n                        10.6,\n                    'total_balance':\n                        2343\n                },\n                data: assets\n\n            };\n            ret.data = data;\n            ctx.body = ret;\n\n\n\n        }\n\n        async detail() {\n            const { ctx, service, config } = this;\n            const miner_id = ctx.params.miner_id;\n            const params = ctx.request.query;\n            let page = parseInt(ctx.request.body.page) || 1;\n            const pageSize = 20;\n            if (page < 1) {\n                page = 1;\n            }\n\n            const ret = {\n                status: 422,\n                message: '',\n                data: {}\n            };\n\n            console.log(page);\n\n\n            const miner_shares = await service.miner.getSharesByMinerId({\n                miner_id: miner_id,\n                pageNumber: page,\n                pageSize: pageSize\n            });\n\n\n            ret.status = 200;\n\n            ret.data = miner_shares;\n            ctx.body = ret;\n        }\n\n        async rename() {\n            const { ctx, service, config } = this;\n            const id = ctx.request.body.id;\n            const miner_alias = ctx.request.body.miner_alias;\n\n            const ret = {\n                status: 422,\n                message: '',\n                data: {}\n            };\n\n\n            const miner_shares = await service.miner.rename({\n                id: id,\n                miner_alias: miner_alias\n            });\n\n\n            ret.status = 200;\n            ret.message = \"修改成功\";\n            ctx.body = ret;\n        }\n\n\n    }\n\n    return MinerController;\n};\n"]}