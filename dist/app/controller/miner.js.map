{"version":3,"sources":["../../../app/controller/miner.js"],"names":["_","require","validator","utility","uuid","module","exports","MinerController","ctx","service","config","ret","status","message","data","uid","account","user_id","miner","getByUserId","assets","body","miner_id","params","request","query","page","parseInt","limit","offset","getSharesByMinerId","miner_shares","app","Controller"],"mappings":";;;;;;;;;;;;AACA,IAAMA,IAAIC,QAAQ,QAAR,CAAV;AACA,IAAMC,YAAYD,QAAQ,WAAR,CAAlB;AACA,IAAME,UAAUF,QAAQ,SAAR,CAAhB;AACA,IAAMG,OAAOH,QAAQ,MAAR,CAAb;;AAEAI,OAAOC,OAAP,GAAiB,eAAO;AAAA,QACdC,eADc;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIJC,uCAJI,GAIqB,IAJrB,CAIJA,GAJI,EAICC,OAJD,GAIqB,IAJrB,CAICA,OAJD,EAIUC,MAJV,GAIqB,IAJrB,CAIUA,MAJV;AAMNC,uCANM,GAMA;AACRC,gDAAQ,GADA;AAERC,iDAAS,EAFD;AAGRC,8CAAM;AAHE,qCANA;AAYNC,uCAZM,GAYAP,IAAIQ,OAAJ,CAAYC,OAZZ;AAAA;AAAA,2CAcSR,QAAQS,KAAR,CAAcC,WAAd,CAA0BJ,GAA1B,CAdT;;AAAA;AAcNK,0CAdM;AAeNN,wCAfM,GAeC;AACTM,gDAAQ;AACJ,iEACI,GAFA;AAGJ,uDACI,IAJA;AAKJ,6DACI;AANA,yCADC;AASTN,8CAAMM;;AATG,qCAfD;;AA2BZT,wCAAIG,IAAJ,GAAWA,IAAX;AACAN,wCAAIa,IAAJ,GAAWV,GAAX;;AA5BY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAmCJH,uCAnCI,GAmCqB,IAnCrB,CAmCJA,GAnCI,EAmCCC,OAnCD,GAmCqB,IAnCrB,CAmCCA,OAnCD,EAmCUC,MAnCV,GAmCqB,IAnCrB,CAmCUA,MAnCV;AAoCNY,4CApCM,GAoCKd,IAAIe,MAAJ,CAAWD,QApChB;AAqCNC,0CArCM,GAqCGf,IAAIgB,OAAJ,CAAYC,KArCf;AAsCNC,wCAtCM,GAsCCC,SAASJ,OAAOG,IAAhB,KAAyB,CAtC1B;AAuCNE,yCAvCM,GAuCE,EAvCF;AAwCNC,0CAxCM,GAwCG,CAACH,OAAO,CAAR,IAAaE,KAxChB;AA0CNjB,uCA1CM,GA0CA;AACRC,gDAAQ,GADA;AAERC,iDAAS,EAFD;AAGRC,8CAAM;AAHE,qCA1CA;AAAA;AAAA,2CAgDeL,QAAQS,KAAR,CAAcY,kBAAd,CAAiC;AACxDR,kDAAUA,QAD8C;AAExDO,gDAAQA,MAFgD;AAGxDD,+CAAOA;AAHiD,qCAAjC,CAhDf;;AAAA;AAgDNG,gDAhDM;AAsDNjB,wCAtDM,GAsDC;AACTM,gDAAQ;;AAEJ,6DAAiB;AAFb,yCADC;AAKTN,8CAAMiB;;AALG,qCAtDD;;AA8DZpB,wCAAIC,MAAJ,GAAa,GAAb;;AAEAD,wCAAIG,IAAJ,GAAWA,IAAX;AACAN,wCAAIa,IAAJ,GAAWV,GAAX;;AAjEY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,MACUqB,IAAIC,UADd;;AAuEpB,WAAO1B,eAAP;AACH,CAxED","file":"miner.js","sourcesContent":["\nconst _ = require('lodash');\nconst validator = require('validator');\nconst utility = require('utility');\nconst uuid = require('uuid');\n\nmodule.exports = app => {\n    class MinerController extends app.Controller {\n\n        async index() {\n            const { ctx, service, config } = this;\n\n            const ret = {\n                status: 200,\n                message: '',\n                data: {}\n            };\n\n            const uid = ctx.account.user_id;\n\n            const assets = await service.miner.getByUserId(uid);\n            const data = {\n                assets: {\n                    'yesterday_balance':\n                        2.5,\n                    'lrc_cny':\n                        10.6,\n                    'total_balance':\n                        2343\n                },\n                data: assets\n\n            };\n            ret.data = data;\n            ctx.body = ret;\n\n\n\n        }\n\n        async detail() {\n            const { ctx, service, config } = this;\n            const miner_id = ctx.params.miner_id;\n            const params = ctx.request.query;\n            const page = parseInt(params.page) || 1;\n            const limit = 20;\n            const offset = (page - 1) * limit;\n            \n            const ret = {\n                status: 422,\n                message: '',\n                data: {}\n            };\n\n            const miner_shares = await service.miner.getSharesByMinerId({\n                miner_id: miner_id,\n                offset: offset,\n                limit: limit\n            });\n\n            const data = {\n                assets: {\n\n                    'total_balance': 2343\n                },\n                data: miner_shares\n\n            };\n            ret.status = 200;\n\n            ret.data = data;\n            ctx.body = ret;\n        }\n\n\n    }\n\n    return MinerController;\n};"]}