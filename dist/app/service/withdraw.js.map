{"version":3,"sources":["../../../app/service/withdraw.js"],"names":["Service","require","WithdrawService","data","app","mysql","insert","ret","pageNumber","pageSize","ctx","uid","account","user_id","query","select","where","limit","Number","offset","orders","result","count","totalCount","page","Math","ceil","module","exports"],"mappings":";;;;;;;;;;;;AACA,IAAMA,UAAUC,QAAQ,KAAR,EAAeD,OAA/B;;IAEME,e;;;;;;;;;;;;gGAIeC,I;;;;;;;uCAGK,KAAKC,GAAL,CAASC,KAAT,CAAeC,MAAf,CAAsB,UAAtB,EACdH,IADc,C;;;AAAZI,mC;iEAKCA,G;;;;;;;;;;;;;;;;;;;;6CAGKC,U;oBAAAA,U,oCAAa,C;2CAAGC,Q;oBAAAA,Q,kCAAW,E;;;;;;AAC/BC,mC,GAAQ,I,CAARA,G;AAEFC,mC,GAAMD,IAAIE,OAAJ,CAAYC,O;AAEpBC,qC,GAAQ;AACRD,6CAASF;AADD,iC;;uCAIO,KAAKP,GAAL,CAASC,KAAT,CAAeU,MAAf,CAAsB,UAAtB,EAAkC;AACjDC,2CAAOF,KAD0C;AAEjDG,2CAAOC,OAAOT,QAAP,CAF0C,EAErB;AAC5BU,4CAAQ,CAACX,aAAa,CAAd,IAAmBC,QAHsB,EAGZ;AACrCW,4CAAQ,CAAC,CAAC,YAAD,EAAe,MAAf,CAAD,CAJyC,CAIhB;AAJgB,iCAAlC,C;;;AAAfC,sC;;uCAOqB,KAAKjB,GAAL,CAASC,KAAT,CAAeiB,KAAf,CAAqB,UAArB,EAAiCR,KAAjC,C;;;AAAnBS,0C;kEAEC;AACHpB,0CAAMkB,MADH;AAEHG,0CAAM;AACF,wDAAgBN,OAAOV,UAAP,CADd;AAEF,sDAAciB,KAAKC,IAAL,CAAUH,aAAad,QAAvB,CAFZ;AAGF,iDAASc;AAHP;;AAFH,iC;;;;;;;;;;;;;;;;;;;EAjCevB,O;;AAgD9B2B,OAAOC,OAAP,GAAiB1B,eAAjB","file":"withdraw.js","sourcesContent":["\nconst Service = require('egg').Service;\n\nclass WithdrawService extends Service {\n\n\n\n    async newAndSave(data) {\n\n\n        const ret = await this.app.mysql.insert('withdraw',\n            data\n\n        );\n\n        return ret;\n    }\n\n    async findAll({ pageNumber = 1, pageSize = 20 }) {\n        const { ctx } = this;\n\n        const uid = ctx.account.user_id;\n\n        let query = {\n            user_id: uid\n        };\n\n        let result = await this.app.mysql.select('withdraw', {\n            where: query,\n            limit: Number(pageSize),    // 返回数据量\n            offset: (pageNumber - 1) * pageSize, // 数据偏移量\n            orders: [['created_at', 'desc']] // 排序方式\n        });\n\n        const totalCount = await this.app.mysql.count('withdraw', query);\n\n        return {\n            data: result,\n            page: {\n                'current_page': Number(pageNumber),\n                'total_page': Math.ceil(totalCount / pageSize),\n                'total': totalCount\n            }\n\n        };\n    }\n\n\n\n}\n\nmodule.exports = WithdrawService;\n"]}